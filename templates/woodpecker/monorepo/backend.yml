# ===========================================
# Woodpecker CI - Monorepo: Backend
# ===========================================
# Copy to: .woodpecker/backend.yml
#
# Woodpecker natively supports multiple pipeline files in .woodpecker/.
# Each .yml becomes an independent workflow.
#
# Only runs when files in packages/backend/ change.
# ===========================================

when:
  - event: push
    branch: main
  - event: pull_request
  - event: tag
  - event: manual
  - path: "packages/backend/**"

steps:
  - name: lint
    image: eclipse-temurin:21-jdk
    commands:
      - cd packages/backend
      - chmod +x gradlew
      - ./gradlew spotlessCheck --no-daemon
    failure: ignore

  - name: build
    image: eclipse-temurin:21-jdk
    commands:
      - cd packages/backend
      - chmod +x gradlew
      - ./gradlew classes --no-daemon
